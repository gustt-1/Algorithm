# [cf2053C] [Bewitching Stargazer](https://codeforces.com/problemset/problem/2053/C)
## 题目描述 

> Wave is given five integers $k$, $l_1$, $r_1$, $l_2$, and $r_2$. Wave wants you to help her count the number of ordered pairs $(x, y)$ such that all of the following are satisfied:

-   $l_1 \leq x \leq r_1$.
-   $l_2 \leq y \leq r_2$.
-   There exists a non-negative integer $n$ such that $\frac{y}{x} = k^n$.

> Wave 给定五个整数 (k, l_1, r_1, l_2, r_2)。请你帮她统计有序对 ((x, y)) 的数量，满足以下条件：1. (l_1 ≤ x ≤ r_1)；2. (l_2 ≤ y ≤ r_2)；3. 存在一个非负整数 (n)，使得 (y/x = k^n)。






## 我的思路
**数学**

##

- 我们需要在两个范围内找到 $(x, y)$ 两个数，满足

$$
\frac{y}{x} = k^n
$$

假设 $x = 1$，则

$$
y = k^n
$$

由此可以得出

$$
n \le \log_k(r)
$$

设

$$
p_k = k^n
$$

由于

$$
\frac{y}{x} = p_k \implies x = \frac{y}{p_k}
$$

又因为

$$
l_2 \le y \le r_2 \implies \left\lceil \frac{l_2}{p_k} \right\rceil \le x \le \left\lfloor \frac{r_2}{p_k} \right\rfloor
$$

再结合

$$
l_1 \le x \le r_1 \implies \max(l_1, \lceil \frac{l_2}{p_k} \rceil) \le x \le \min(r_1, \lfloor \frac{r_2}{p_k} \rfloor)
$$

把满足上式的整数 $x$ 的个数累加到答案中即可。





##
---

## 时间复杂度



---

## 空间复杂度



---

## Go 代码

```Go

package main

import (
	"bufio"
	. "fmt"
	"io"
	"os"
)

func solve(in io.Reader, out io.Writer) {
	var T int
	for Fscan(in, &T); T > 0; T-- {
		var k, l1, r1, l2, r2 int
		Fscan(in, &k, &l1, &r1, &l2, &r2)
		ans := 0
		for pk := 1; pk <= r2; pk *= k {
			l := max(l1, (l2-1)/pk+1)
			r := min(r1, r2/pk)
			ans += max(r-l+1, 0)
		}
		Fprintln(out, ans)
	}

}
func abs(x int) int {
	if x < 0 {
		return -x
	}
	return x
}

func main() {
	solve(bufio.NewReader(os.Stdin), os.Stdout)
}



```
---

## C++ 代码

```C++






```
---
## Python 代码

```Python



```

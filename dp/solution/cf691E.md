# [cf691E] [Xor-sequences](https://codeforces.com/problemset/problem/691/E)

## 题目描述
您将获得 `n` 个整数 $a_1, a_2, ..., a_n$ 。

如果对于每个 $1≤i≤k-1$ 数字 $x_i$ 的二进制表示形式中有 $1$ 个，则整数序列 $x_1, x_2,..., x_k$ 称为`“异或序列”`  $x_i+1$ 是 $3$ 的倍数 和 $x∈$ { $a_0,a_1,...a_n$ } 对于所有 $1≤i≤k$。
存在多少个长度为 $k$ 的`“异或序列”`？输出对 $10^9+7$ 取模的答案。
请注意，如果 $a=[1,1]$ 和 $k=1$ 则答案为 $2$ ，因为您应该将 $a$ 中的答案视为不同。



---


## 输入

>


## 输出

>

---

## 我的思路
**矩阵快速幂优化DP**

> 

---

## 时间复杂度

$O()$

---

## 空间复杂度

$O()$

---

## Go 代码

```Go
package main

import (
	"bufio"
	. "fmt"
	"io"
	"math/bits"
	"os"
)

const inf = 0x3f3f3f3f

type (
	i64 = int64
	i32 = int32
	u64 = uint64
	u32 = uint32
)

const mod = int(1e9 + 7)

type matrix [][]int

func newMatrix(n, m int) matrix {
	a := make(matrix, n)
	for i := range a {
		a[i] = make([]int, m)
	}
	return a
}

func (a matrix) mul(b matrix) matrix {
	c := newMatrix(len(a), len(b[0]))
	for i, row := range a {
		for k, x := range row {
			if x == 0 {
				continue
			}
			for j, y := range b[k] {
				c[i][j] = (c[i][j] + x*y) % mod
			}
		}
	}
	return c
}

func (a matrix) powMul(n int, f0 matrix) matrix {
	res := f0
	for ; n > 0; n /= 2 {
		if n&1 != 0 {
			res = a.mul(res)
		}
		a = a.mul(a)
	}
	return res
}

func solve(in io.Reader, out io.Writer) {
	//var T int
	//for Fscan(in, &T); T > 0; T-- {
	var n, k int
	Fscan(in, &n, &k)
	ans := 0
	a := make([]int, n)
	for i := range a {
		Fscan(in, &a[i])
	}
	m := newMatrix(n, n)
	for i, v := range a {
		for j, w := range a[:i+1] {
			if bits.OnesCount(uint(v^w))%3 == 0 {
				m[i][j] = 1
				m[j][i] = 1
			}
		}
	}

	f0 := newMatrix(n, 1)
	for i := range f0 {
		f0[i][0] = 1
	}

	fk := m.powMul(k-1, f0)
	for _, row := range fk {
		ans += row[0]
	}
	Fprint(out, ans%mod)
	//}
}

func abs(x int) int {
	if x < 0 {
		return -x
	}
	return x
}

func gcd(x, y int) int {
	for y != 0 {
		x, y = y, x%y
	}
	return x
}

func max64(x, y i64) i64 {
	if x > y {
		return x
	}
	return y
}

func min64(x, y i64) i64 {
	if x < y {
		return x
	}
	return y
}

func main() {
	solve(bufio.NewReader(os.Stdin), os.Stdout)
}
```
---

## C++ 代码

```C++
```
---
## Python 代码

```Python
```
